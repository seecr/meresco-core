isSuSE && PACKAGES="python2.4 python-profiler python2.4-xml python-twisted-web rsync wget"
isFedora && PACKAGES="python PyXML python-twisted-web rsync wget gcc"



username=teddy
groupname=$(id --group --name $username)
configfile=$teddydir/config/config.xml
if [ ! -f $configfile ]; then
	echo "<?xml version=\"1.0\"?>
<configuration>
        <storage>$merescodir/index/storage</storage>
        <lucene>$merescodir/index/lucene</lucene>
</configuration>" > $configfile
	chown $username.$groupname $configfile
fi

#unpack example index
(
	cd $merescodir
	tar xzf $distdir/example_index.tar.gz
	chown $username.$groupname index -R
)

servicedir=/service/teddy-service
if [ ! -d $servicedir ]; then
	mkdir -p $servicedir/log/main
	chown $username.$groupname $servicedir/log/main
	echo "#!/bin/bash

exec /usr/local/bin/setuidgid $username /usr/local/bin/multilog t -n20 $servicedir/log/main 2>&1" > $servicedir/log/run
	chmod +x $servicedir/log/run

	echo "#!/bin/bash

cd $teddydir/src
export PYTHONPATH=$merescodir:$cq2_dep_dir:$teddydir/amara1.0
export LD_LIBRARY_PATH=/usr/local/lib
export TEDDY_CONFIG_PATH=$teddydir/config
exec /usr/local/bin/setuidgid $username python2.4 teddyserver.py 2>&1" > $servicedir/run
	chmod +x $servicedir/run
fi

if isDebian; then
	configureIpTables teddy 8000
else
	echo "* Please allow access to port 8000 on your firewall"
fi

echo "*
*
* We have created an example index in order to test the installation.
* - Go to http://localhost:8000/sru?version=1.1&operation=searchRetrieve&query=year:2007
